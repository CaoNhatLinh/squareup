import { useMemo } from "react";import { calculateSingleDiscount } from "@/utils/discountUtils";export function useDiscountCalculation(cart, activeDiscounts) {  return useMemo(() => {    if (!activeDiscounts || Object.keys(activeDiscounts).length === 0 || cart.length === 0) {      return {        appliedDiscount: null,        totalDiscount: 0,        itemDiscounts: {},        discountBreakdown: null,        subtotal: cart.reduce((sum, item) => sum + item.totalPrice, 0)      };    }    const discounts = Object.values(activeDiscounts);    const discountResults = [];    for (const discount of discounts) {      const result = calculateSingleDiscount(discount, cart);      if (result && result.discountAmount > 0) {        discountResults.push(result);      }    }    if (discountResults.length === 0) {      return {        appliedDiscount: null,        totalDiscount: 0,        itemDiscounts: {},        discountBreakdown: null,        subtotal: cart.reduce((sum, item) => sum + item.totalPrice, 0)      };    }    const appliedDiscounts = [];    const combinedItemDiscounts = {};    const itemsAlreadyDiscounted = new Set();    const discountAmounts = {};    let totalDiscount = 0;    discountResults.sort((a, b) => b.discountAmount - a.discountAmount);    for (const result of discountResults) {      const affectedItemKeys = Object.keys(result.itemDiscounts);      const hasOverlap = affectedItemKeys.some(key => itemsAlreadyDiscounted.has(key));      if (!hasOverlap) {        appliedDiscounts.push(result.discount);        totalDiscount += result.discountAmount;        discountAmounts[result.discount.id] = result.discountAmount;        Object.assign(combinedItemDiscounts, result.itemDiscounts);        affectedItemKeys.forEach(key => itemsAlreadyDiscounted.add(key));      }    }    const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);    return {      appliedDiscount: appliedDiscounts[0] || null,      appliedDiscounts: appliedDiscounts,      discountAmounts: discountAmounts,      totalDiscount: totalDiscount,      itemDiscounts: combinedItemDiscounts,      discountBreakdown: appliedDiscounts.map(d => ({        discountId: d.id,        discountName: d.name,        discountType: d.amountType,        discountValue: d.amount,        discountAmount: discountAmounts[d.id] || 0,      })),      subtotal,      total: subtotal - totalDiscount    };  }, [cart, activeDiscounts]);}